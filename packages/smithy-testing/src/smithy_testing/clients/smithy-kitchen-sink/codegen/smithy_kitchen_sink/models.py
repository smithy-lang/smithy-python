# Code generated by smithy-python-codegen DO NOT EDIT.

import logging
from dataclasses import dataclass
from typing import Any, Literal, Self

from smithy_core.deserializers import ShapeDeserializer
from smithy_core.documents import TypeRegistry
from smithy_core.exceptions import ModeledError
from smithy_core.schemas import APIOperation, Schema
from smithy_core.serializers import ShapeSerializer
from smithy_core.shapes import ShapeID

from ._private.schemas import (
    CREATE_ITEM as _SCHEMA_CREATE_ITEM,
)
from ._private.schemas import (
    CREATE_ITEM_INPUT as _SCHEMA_CREATE_ITEM_INPUT,
)
from ._private.schemas import (
    CREATE_ITEM_OUTPUT as _SCHEMA_CREATE_ITEM_OUTPUT,
)
from ._private.schemas import (
    GET_ITEM as _SCHEMA_GET_ITEM,
)
from ._private.schemas import (
    GET_ITEM_INPUT as _SCHEMA_GET_ITEM_INPUT,
)
from ._private.schemas import (
    GET_ITEM_OUTPUT as _SCHEMA_GET_ITEM_OUTPUT,
)
from ._private.schemas import (
    INTERNAL_ERROR as _SCHEMA_INTERNAL_ERROR,
)
from ._private.schemas import (
    ITEM_NOT_FOUND as _SCHEMA_ITEM_NOT_FOUND,
)
from ._private.schemas import (
    SERVICE_UNAVAILABLE_ERROR as _SCHEMA_SERVICE_UNAVAILABLE_ERROR,
)
from ._private.schemas import (
    THROTTLING_ERROR as _SCHEMA_THROTTLING_ERROR,
)

logger = logging.getLogger(__name__)


class ServiceError(ModeledError):
    """Base error for all errors in the service.

    Some exceptions do not extend from this class, including
    synthetic, implicit, and shared exception types.
    """


@dataclass(kw_only=True)
class CreateItemInput:
    name: str | None = None

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_CREATE_ITEM_INPUT, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.name is not None:
            serializer.write_string(
                _SCHEMA_CREATE_ITEM_INPUT.members["name"], self.name
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["name"] = de.read_string(
                        _SCHEMA_CREATE_ITEM_INPUT.members["name"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_CREATE_ITEM_INPUT, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class CreateItemOutput:
    id: str | None = None

    name: str | None = None

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_CREATE_ITEM_OUTPUT, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.id is not None:
            serializer.write_string(_SCHEMA_CREATE_ITEM_OUTPUT.members["id"], self.id)

        if self.name is not None:
            serializer.write_string(
                _SCHEMA_CREATE_ITEM_OUTPUT.members["name"], self.name
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["id"] = de.read_string(
                        _SCHEMA_CREATE_ITEM_OUTPUT.members["id"]
                    )

                case 1:
                    kwargs["name"] = de.read_string(
                        _SCHEMA_CREATE_ITEM_OUTPUT.members["name"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_CREATE_ITEM_OUTPUT, consumer=_consumer)
        return kwargs


CREATE_ITEM = APIOperation(
    input=CreateItemInput,
    output=CreateItemOutput,
    schema=_SCHEMA_CREATE_ITEM,
    input_schema=_SCHEMA_CREATE_ITEM_INPUT,
    output_schema=_SCHEMA_CREATE_ITEM_OUTPUT,
    error_registry=TypeRegistry({}),
    effective_auth_schemes=[ShapeID("smithy.api#httpBasicAuth")],
)


@dataclass(kw_only=True)
class GetItemInput:
    id: str | None = None

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_GET_ITEM_INPUT, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.id is not None:
            serializer.write_string(_SCHEMA_GET_ITEM_INPUT.members["id"], self.id)

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["id"] = de.read_string(_SCHEMA_GET_ITEM_INPUT.members["id"])

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_GET_ITEM_INPUT, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class GetItemOutput:
    message: str | None = None

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_GET_ITEM_OUTPUT, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.message is not None:
            serializer.write_string(
                _SCHEMA_GET_ITEM_OUTPUT.members["message"], self.message
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["message"] = de.read_string(
                        _SCHEMA_GET_ITEM_OUTPUT.members["message"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_GET_ITEM_OUTPUT, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class InternalError(ServiceError):
    fault: Literal["client", "server"] | None = "server"
    is_retry_safe: bool | None = True

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_INTERNAL_ERROR, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.message is not None:
            serializer.write_string(
                _SCHEMA_INTERNAL_ERROR.members["message"], self.message
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["message"] = de.read_string(
                        _SCHEMA_INTERNAL_ERROR.members["message"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_INTERNAL_ERROR, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class ItemNotFound(ServiceError):
    fault: Literal["client", "server"] | None = "client"

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_ITEM_NOT_FOUND, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.message is not None:
            serializer.write_string(
                _SCHEMA_ITEM_NOT_FOUND.members["message"], self.message
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["message"] = de.read_string(
                        _SCHEMA_ITEM_NOT_FOUND.members["message"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_ITEM_NOT_FOUND, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class ServiceUnavailableError(ServiceError):
    fault: Literal["client", "server"] | None = "server"
    is_retry_safe: bool | None = True

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_SERVICE_UNAVAILABLE_ERROR, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.message is not None:
            serializer.write_string(
                _SCHEMA_SERVICE_UNAVAILABLE_ERROR.members["message"], self.message
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["message"] = de.read_string(
                        _SCHEMA_SERVICE_UNAVAILABLE_ERROR.members["message"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_SERVICE_UNAVAILABLE_ERROR, consumer=_consumer)
        return kwargs


@dataclass(kw_only=True)
class ThrottlingError(ServiceError):
    fault: Literal["client", "server"] | None = "client"
    is_retry_safe: bool | None = True
    is_throttling_error: bool = True

    def serialize(self, serializer: ShapeSerializer):
        serializer.write_struct(_SCHEMA_THROTTLING_ERROR, self)

    def serialize_members(self, serializer: ShapeSerializer):
        if self.message is not None:
            serializer.write_string(
                _SCHEMA_THROTTLING_ERROR.members["message"], self.message
            )

    @classmethod
    def deserialize(cls, deserializer: ShapeDeserializer) -> Self:
        return cls(**cls.deserialize_kwargs(deserializer))

    @classmethod
    def deserialize_kwargs(cls, deserializer: ShapeDeserializer) -> dict[str, Any]:
        kwargs: dict[str, Any] = {}

        def _consumer(schema: Schema, de: ShapeDeserializer) -> None:
            match schema.expect_member_index():
                case 0:
                    kwargs["message"] = de.read_string(
                        _SCHEMA_THROTTLING_ERROR.members["message"]
                    )

                case _:
                    logger.debug("Unexpected member schema: %s", schema)

        deserializer.read_struct(_SCHEMA_THROTTLING_ERROR, consumer=_consumer)
        return kwargs


GET_ITEM = APIOperation(
    input=GetItemInput,
    output=GetItemOutput,
    schema=_SCHEMA_GET_ITEM,
    input_schema=_SCHEMA_GET_ITEM_INPUT,
    output_schema=_SCHEMA_GET_ITEM_OUTPUT,
    error_registry=TypeRegistry(
        {
            ShapeID("smithy.python.test#ItemNotFound"): ItemNotFound,
            ShapeID("smithy.python.test#ThrottlingError"): ThrottlingError,
            ShapeID("smithy.python.test#InternalError"): InternalError,
            ShapeID(
                "smithy.python.test#ServiceUnavailableError"
            ): ServiceUnavailableError,
        }
    ),
    effective_auth_schemes=[ShapeID("smithy.api#httpBasicAuth")],
)
