# Code generated by smithy-python-codegen DO NOT EDIT.

from collections.abc import Callable
from dataclasses import dataclass
from typing import Any, TypeAlias, Union

from smithy_aws_core.aio.protocols import RestJsonClientProtocol
from smithy_core.aio.endpoints import StaticEndpointResolver
from smithy_core.aio.interfaces import (
    ClientProtocol,
    ClientTransport,
)
from smithy_core.aio.interfaces import (
    EndpointResolver as _EndpointResolver,
)
from smithy_core.aio.interfaces.auth import AuthScheme
from smithy_core.interceptors import Interceptor
from smithy_core.interfaces import URI
from smithy_core.interfaces.retries import RetryStrategy
from smithy_core.retries import SimpleRetryStrategy
from smithy_core.shapes import ShapeID
from smithy_http.aio.aiohttp import AIOHTTPClient
from smithy_http.interfaces import HTTPRequestConfiguration

from ._private.schemas import SMITHY_KITCHEN_SINK as _SCHEMA_SMITHY_KITCHEN_SINK
from .auth import HTTPAuthSchemeResolver
from .models import CreateItemInput, CreateItemOutput, GetItemInput, GetItemOutput

_ServiceInterceptor = Union[
    Interceptor[CreateItemInput, CreateItemOutput, Any, Any],
    Interceptor[GetItemInput, GetItemOutput, Any, Any],
]


@dataclass(init=False)
class Config:
    """Configuration for SmithyKitchenSink."""

    auth_scheme_resolver: HTTPAuthSchemeResolver
    auth_schemes: dict[ShapeID, AuthScheme[Any, Any, Any, Any]]
    endpoint_resolver: _EndpointResolver
    endpoint_uri: str | URI | None
    http_request_config: HTTPRequestConfiguration | None
    interceptors: list[_ServiceInterceptor]
    protocol: ClientProtocol[Any, Any] | None
    retry_strategy: RetryStrategy
    transport: ClientTransport[Any, Any] | None

    def __init__(
        self,
        *,
        auth_scheme_resolver: HTTPAuthSchemeResolver | None = None,
        auth_schemes: dict[ShapeID, AuthScheme[Any, Any, Any, Any]] | None = None,
        endpoint_resolver: _EndpointResolver | None = None,
        endpoint_uri: str | URI | None = None,
        http_request_config: HTTPRequestConfiguration | None = None,
        interceptors: list[_ServiceInterceptor] | None = None,
        protocol: ClientProtocol[Any, Any] | None = None,
        retry_strategy: RetryStrategy | None = None,
        transport: ClientTransport[Any, Any] | None = None,
    ):
        """Constructor.

        :param auth_scheme_resolver:
             An auth scheme resolver that determines the auth scheme for each operation.

        :param auth_schemes:
             A map of auth scheme ids to auth schemes.

        :param endpoint_resolver:
             The endpoint resolver used to resolve the final endpoint per-operation based on
             the configuration.

        :param endpoint_uri:
             A static URI to route requests to.

        :param http_request_config:
             Configuration for individual HTTP requests.

        :param interceptors:
             The list of interceptors, which are hooks that are called during the execution
             of a request.

        :param protocol:
             The protocol to serialize and deserialize requests with.

        :param retry_strategy:
             The retry strategy for issuing retry tokens and computing retry delays.

        :param transport:
             The transport to use to send requests (e.g. an HTTP client).

        """
        self.auth_scheme_resolver = auth_scheme_resolver or HTTPAuthSchemeResolver()
        self.auth_schemes = auth_schemes or {}
        self.endpoint_resolver = endpoint_resolver or StaticEndpointResolver()
        self.endpoint_uri = endpoint_uri
        self.http_request_config = http_request_config
        self.interceptors = interceptors or []
        self.protocol = protocol or RestJsonClientProtocol(_SCHEMA_SMITHY_KITCHEN_SINK)
        self.retry_strategy = retry_strategy or SimpleRetryStrategy()
        self.transport = transport or AIOHTTPClient()

    def set_auth_scheme(self, scheme: AuthScheme[Any, Any, Any, Any]) -> None:
        """Sets the implementation of an auth scheme.

        Using this method ensures the correct key is used.

        :param scheme: The auth scheme to add.
        """
        self.auth_schemes[scheme.scheme_id] = scheme


#
# A callable that allows customizing the config object on each request.
#
Plugin: TypeAlias = Callable[[Config], None]
