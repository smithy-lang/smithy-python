# Code generated by smithy-python-codegen DO NOT EDIT.

from collections.abc import Callable
from dataclasses import dataclass
from typing import Any, TypeAlias, Union

from smithy_aws_core.aio.protocols import RestJsonClientProtocol
from smithy_aws_core.auth import SigV4AuthScheme
from smithy_aws_core.endpoints.standard_regional import (
    StandardRegionalEndpointsResolver as _RegionalResolver,
)
from smithy_aws_core.identity import AWSCredentialsIdentity, AWSIdentityProperties
from smithy_core.aio.interfaces import (
    ClientProtocol,
    ClientTransport,
)
from smithy_core.aio.interfaces import (
    EndpointResolver as _EndpointResolver,
)
from smithy_core.aio.interfaces.auth import AuthScheme
from smithy_core.aio.interfaces.identity import IdentityResolver
from smithy_core.interceptors import Interceptor
from smithy_core.interfaces import URI
from smithy_core.interfaces.retries import RetryStrategy
from smithy_core.retries import StandardRetryStrategy
from smithy_core.shapes import ShapeID
from smithy_http.aio.aiohttp import AIOHTTPClient
from smithy_http.interfaces import HTTPRequestConfiguration

from ._private.schemas import AWS_KITCHEN_SINK as _SCHEMA_AWS_KITCHEN_SINK
from .auth import HTTPAuthSchemeResolver
from .models import CreateItemInput, CreateItemOutput, GetItemInput, GetItemOutput

_ServiceInterceptor = Union[
    Interceptor[CreateItemInput, CreateItemOutput, Any, Any],
    Interceptor[GetItemInput, GetItemOutput, Any, Any],
]


@dataclass(init=False)
class Config:
    """Configuration for AwsKitchenSink."""

    auth_scheme_resolver: HTTPAuthSchemeResolver
    auth_schemes: dict[ShapeID, AuthScheme[Any, Any, Any, Any]]
    aws_access_key_id: str | None
    aws_credentials_identity_resolver: (
        IdentityResolver[AWSCredentialsIdentity, AWSIdentityProperties] | None
    )
    aws_secret_access_key: str | None
    aws_session_token: str | None
    endpoint_resolver: _EndpointResolver
    endpoint_uri: str | URI | None
    http_request_config: HTTPRequestConfiguration | None
    interceptors: list[_ServiceInterceptor]
    protocol: ClientProtocol[Any, Any] | None
    region: str | None
    retry_strategy: RetryStrategy
    sdk_ua_app_id: str | None
    transport: ClientTransport[Any, Any] | None
    user_agent_extra: str | None

    def __init__(
        self,
        *,
        auth_scheme_resolver: HTTPAuthSchemeResolver | None = None,
        auth_schemes: dict[ShapeID, AuthScheme[Any, Any, Any, Any]] | None = None,
        aws_access_key_id: str | None = None,
        aws_credentials_identity_resolver: IdentityResolver[
            AWSCredentialsIdentity, AWSIdentityProperties
        ]
        | None = None,
        aws_secret_access_key: str | None = None,
        aws_session_token: str | None = None,
        endpoint_resolver: _EndpointResolver | None = None,
        endpoint_uri: str | URI | None = None,
        http_request_config: HTTPRequestConfiguration | None = None,
        interceptors: list[_ServiceInterceptor] | None = None,
        protocol: ClientProtocol[Any, Any] | None = None,
        region: str | None = None,
        retry_strategy: RetryStrategy | None = None,
        sdk_ua_app_id: str | None = None,
        transport: ClientTransport[Any, Any] | None = None,
        user_agent_extra: str | None = None,
    ):
        """Constructor.

        :param auth_scheme_resolver:
             An auth scheme resolver that determines the auth scheme for each operation.

        :param auth_schemes:
             A map of auth scheme ids to auth schemes.

        :param aws_access_key_id:
             The identifier for a secret access key.

        :param aws_credentials_identity_resolver:
             Resolves AWS Credentials. Required for operations that use Sigv4 Auth.

        :param aws_secret_access_key:
             A secret access key that can be used to sign requests.

        :param aws_session_token:
             An access key ID that identifies temporary security credentials.

        :param endpoint_resolver:
             The endpoint resolver used to resolve the final endpoint per-operation based on
             the configuration.

        :param endpoint_uri:
             A static URI to route requests to.

        :param http_request_config:
             Configuration for individual HTTP requests.

        :param interceptors:
             The list of interceptors, which are hooks that are called during the execution
             of a request.

        :param protocol:
             The protocol to serialize and deserialize requests with.

        :param region:
             The AWS region to connect to. The configured region is used to determine the
             service endpoint.

        :param retry_strategy:
             The retry strategy for issuing retry tokens and computing retry delays.

        :param sdk_ua_app_id:
             A unique and opaque application ID that is appended to the User-Agent header.

        :param transport:
             The transport to use to send requests (e.g. an HTTP client).

        :param user_agent_extra:
             Additional suffix to be added to the User-Agent header.

        """
        self.auth_scheme_resolver = auth_scheme_resolver or HTTPAuthSchemeResolver()
        self.auth_schemes = auth_schemes or {
            ShapeID("aws.auth#sigv4"): SigV4AuthScheme(service="awskitchensink")
        }
        self.aws_access_key_id = aws_access_key_id
        self.aws_credentials_identity_resolver = aws_credentials_identity_resolver
        self.aws_secret_access_key = aws_secret_access_key
        self.aws_session_token = aws_session_token
        self.endpoint_resolver = endpoint_resolver or _RegionalResolver(
            endpoint_prefix="AwsKitchenSink"
        )
        self.endpoint_uri = endpoint_uri
        self.http_request_config = http_request_config
        self.interceptors = interceptors or []
        self.protocol = protocol or RestJsonClientProtocol(_SCHEMA_AWS_KITCHEN_SINK)
        self.region = region
        self.retry_strategy = retry_strategy or StandardRetryStrategy()
        self.sdk_ua_app_id = sdk_ua_app_id
        self.transport = transport or AIOHTTPClient()
        self.user_agent_extra = user_agent_extra

    def set_auth_scheme(self, scheme: AuthScheme[Any, Any, Any, Any]) -> None:
        """Sets the implementation of an auth scheme.

        Using this method ensures the correct key is used.

        :param scheme: The auth scheme to add.
        """
        self.auth_schemes[scheme.scheme_id] = scheme


#
# A callable that allows customizing the config object on each request.
#
Plugin: TypeAlias = Callable[[Config], None]
